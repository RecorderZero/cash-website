import{p as q,ao as E,g as U,P as K,J as H,e as b,z as F,X as J,K as T,h as M,ap as X,i as n,F as Q,G as B,ac as L,T as z,c as W,a8 as Y,d as Z,s as G,B as ee,aq as te,ar as ae,am as ne,k as le,w as O,o as oe,v as R,x as j,l as se}from"./index-g4JSRDqu.js";import{_ as ie}from"./plugin-vueexport-helper-DlAUqK2U.js";import{V as $}from"./VContainer-DunB4RCO.js";import{m as re,a as ue,u as ce,V as de}from"./VField-DmVHd4CN.js";import{a as N,m as me,u as ve}from"./VOverlay-dCKqE5Db.js";import{d as fe,V as be}from"./VBtn-C33OmYzY.js";import{k as ge,q as pe,t as ke,v as ye,b as he,j as Ve,w as we,x as Pe,o as xe,e as Ce,r as Se,g as _e,f as Fe}from"./transition-Bbfiy8Sh.js";import{f as Te}from"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./index-DcL8uSpd.js";import"./lazy-BJBsRlXv.js";const Be=q({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...ge(),...re(),...E(ue({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),Ae=U()({name:"VOtpInput",props:Be(),emits:{finish:e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,o){let{attrs:l,emit:s,slots:u}=o;const{dimensionStyles:g}=pe(e),{isFocused:v,focus:P,blur:y}=ce(e),i=K(e,"modelValue","",t=>String(t).split(""),t=>t.join("")),{t:x}=H(),C=b(()=>Number(e.length)),h=b(()=>Array(C.value).fill(0)),r=F(-1),V=F(),f=F([]),p=b(()=>f.value[r.value]);function w(){if(e.type==="number"&&/[^0-9]/g.test(p.value.value)){p.value.value="";return}const t=i.value.slice(),a=p.value.value;t[r.value]=a;let c=null;r.value>i.value.length?c=i.value.length+1:r.value+1!==C.value&&(c="next"),i.value=t,c&&L(V.value,c)}function A(t){const a=i.value.slice(),c=r.value;let d=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(t.key)&&(t.preventDefault(),t.key==="ArrowLeft"?d="prev":t.key==="ArrowRight"?d="next":["Backspace","Delete"].includes(t.key)&&(a[r.value]="",i.value=a,r.value>0&&t.key==="Backspace"?d="prev":requestAnimationFrame(()=>{var m;(m=f.value[c])==null||m.select()})),requestAnimationFrame(()=>{d!=null&&L(V.value,d)}))}function D(t,a){var c,d;a.preventDefault(),a.stopPropagation(),i.value=(((c=a==null?void 0:a.clipboardData)==null?void 0:c.getData("Text"))??"").split(""),(d=f.value)==null||d[t].blur()}function I(){i.value=[]}function k(t,a){P(),r.value=a}function S(){y(),r.value=-1}return J({VField:{color:b(()=>e.color),bgColor:b(()=>e.color),baseColor:b(()=>e.baseColor),disabled:b(()=>e.disabled),error:b(()=>e.error),variant:b(()=>e.variant)}},{scoped:!0}),T(i,t=>{t.length===C.value&&s("finish",t.join(""))},{deep:!0}),T(r,t=>{t<0||z(()=>{var a;(a=f.value[t])==null||a.select()})}),M(()=>{var c;const[t,a]=X(l);return n("div",B({class:["v-otp-input",{"v-otp-input--divided":!!e.divider},e.class],style:[e.style]},t),[n("div",{ref:V,class:"v-otp-input__content",style:[g.value]},[h.value.map((d,m)=>n(Q,null,[e.divider&&m!==0&&n("span",{class:"v-otp-input__divider"},[e.divider]),n(de,{focused:v.value&&e.focusAll||r.value===m,key:m},{...u,loader:void 0,default:()=>n("input",{ref:_=>f.value[m]=_,"aria-label":x(e.label,m+1),autofocus:m===0&&e.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:e.disabled,inputmode:e.type==="number"?"numeric":"text",min:e.type==="number"?0:void 0,maxlength:"1",placeholder:e.placeholder,type:e.type==="number"?"text":e.type,value:i.value[m],onInput:w,onFocus:_=>k(_,m),onBlur:S,onKeydown:A,onPaste:_=>D(m,_)},null)})])),n("input",B({class:"v-otp-input-input",type:"hidden"},a,{value:i.value.join("")}),null),n(N,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!e.loading,persistent:!0},{default:()=>{var d;return[((d=u.loader)==null?void 0:d.call(u))??n(fe,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),(c=u.default)==null?void 0:c.call(u)])])}),{blur:()=>{var t;(t=f.value)==null||t.some(a=>a.blur())},focus:()=>{var t;(t=f.value)==null||t[0].focus()},reset:I,isFocused:v}}});function De(e){const o=G(e);let l=-1;function s(){clearInterval(l)}function u(){s(),z(()=>o.value=e)}function g(v){const P=v?getComputedStyle(v):{transitionDuration:.2},y=parseFloat(P.transitionDuration)*1e3||200;if(s(),o.value<=0)return;const i=performance.now();l=window.setInterval(()=>{const x=performance.now()-i+y;o.value=Math.max(e-x,0),o.value<=0&&s()},y)}return ae(s),{clear:s,time:o,start:g,reset:u}}const Ie=q({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...ke({location:"bottom"}),...ye(),...he(),...Ve(),...W(),...Y(me({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Oe=U()({name:"VSnackbar",props:Ie(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:l}=o;const s=K(e,"modelValue"),{locationStyles:u}=we(e),{positionClasses:g}=Pe(e),{scopeId:v}=ve(),{themeClasses:P}=Z(e),{colorClasses:y,colorStyles:i,variantClasses:x}=xe(e),{roundedClasses:C}=Ce(e),h=De(Number(e.timeout)),r=F(),V=F(),f=G(!1);T(s,w),T(()=>e.timeout,w),ee(()=>{s.value&&w()});let p=-1;function w(){h.reset(),window.clearTimeout(p);const k=Number(e.timeout);if(!s.value||k===-1)return;const S=te(V.value);h.start(S),p=window.setTimeout(()=>{s.value=!1},k)}function A(){h.reset(),window.clearTimeout(p)}function D(){f.value=!0,A()}function I(){f.value=!1,w()}return M(()=>{const k=N.filterProps(e),S=!!(l.default||l.text||e.text);return n(N,B({ref:r,class:["v-snackbar",{"v-snackbar--active":s.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},g.value,e.class],style:e.style},k,{modelValue:s.value,"onUpdate:modelValue":t=>s.value=t,contentProps:B({class:["v-snackbar__wrapper",P.value,y.value,C.value,x.value],style:[u.value,i.value],onPointerenter:D,onPointerleave:I},k.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},v),{default:()=>{var t,a;return[Se(!1,"v-snackbar"),e.timer&&!f.value&&n("div",{key:"timer",class:"v-snackbar__timer"},[n(_e,{ref:V,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":h.time.value},null)]),S&&n("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((t=l.text)==null?void 0:t.call(l))??e.text,(a=l.default)==null?void 0:a.call(l)]),l.actions&&n(Fe,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[n("div",{class:"v-snackbar__actions"},[l.actions()])]})]},activator:l.activator})}),Te({},r)}}),Re={data:()=>({timer:null,time:60,loading:!1,snackbar:!1,snackbarColor:"default",otp:"",text:"",expectedOtp:"123456",username:"DogCom"}),mounted(){this.timer=setInterval(this.countdown,1e3)},methods:{async onFinish(e){this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackbarColor=e===this.expectedOtp?"success":"warning",this.text=`Processed OTP with "${e}" (${this.snackbarColor})`,this.snackbar=!0},1e3),e===this.expectedOtp&&(await new Promise(o=>setTimeout(o,3e3)),ne.push({name:"ResetPassword",params:{username:this.username}}))},countdown(){this.time--,this.time==0&&clearInterval(this.timer)},resendOTP(){}},beforeUnmount(){clearInterval(this.timer)}},Ne=R("span",{class:"text-h4"},[R("strong",null,"請輸入驗證碼")],-1);function Le(e,o,l,s,u,g){return oe(),le($,{class:"d-flex flex-column fill-height justify-center"},{default:O(()=>[Ne,n(Ae,{modelValue:e.otp,"onUpdate:modelValue":o[0]||(o[0]=v=>e.otp=v),type:"password",loading:e.loading,onFinish:g.onFinish},null,8,["modelValue","loading","onFinish"]),n($,{class:"d-flex flex-row justify-center align-center"},{default:O(()=>[R("div",null,"驗證碼將在"+j(e.time)+"秒后失效",1),n(be,{class:"mx-5 bg-success",text:"重新發送",onClick:g.resendOTP},null,8,["onClick"])]),_:1}),n(Oe,{modelValue:e.snackbar,"onUpdate:modelValue":o[1]||(o[1]=v=>e.snackbar=v),color:e.snackbarColor,timeout:2e3},{default:O(()=>[se(j(e.text),1)]),_:1},8,["modelValue","color"])]),_:1})}const Xe=ie(Re,[["render",Le]]);export{Xe as default};
